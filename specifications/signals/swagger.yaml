swagger: '2.0'
info:
  title: Signals API
  description: Signals REST API
  version: 2.0.0
schemes:
  - https
basePath: /signals/2.0.0/api
consumes:
  - application/json
produces:
  - application/json
securityDefinitions:
  # certificate: # ???
    # crt: signals.crt
    # key: signals.key
paths:

  /event:
    get:
      description: |
        Gets `Event` objects.
      parameters:
        - name: last_id
          in: query
          description: Last event id
          required: true
          type: number
          format: double
      responses:
        200:
          description: Successful response
          schema:
            $ref: '#/definitions/EventResponse'

definitions:

  Location: # should this just be an extensible path? /???/fac/dept/room/bed/???
    type: object
    properties:
      facility:
        type: string
      department:
        type: string
      room:
        type: string
      bed:
        type: string
      
  Name:
    type: object
    properties:
      first:
        type: string
      middle:
        type: string
      last:
        type: string
        
  EventResponse:
    type: object
    properties:
      data:
        type: array
        items:
          $ref: '#/definitions/Event'
          
  Event:
    type: object
    discriminator: class_
    properties:
      signals:
        type: string # 2.0.0
        required: true
      uuid:
        type: string
        required: true
      class_:
        type: string
        required: true
      provenance:
        type: array
        items: string
# ['https://clinapi/prod/v1.0.0/api/GetDemographics', 'clinstream-mux', 'mm-filter', 'mm-transform', 'mm-predict', 'notify', 'https://signals/prod/v2.0.0/api/event'] # NotifyEvent
        required: true
      transaction_on:
        type: date-time
        required: true
      valid_on:
        type: date-time
      status:
        type: enum
        
  PatientEvent:
    type: object
    allOf:
      - $ref: '#/definitions/Event'
      - properties:
          patient_id:
            type: string
            required: true
        
  PatientCareteamEvent:
    type: object
    allOf:
      - $ref: '#/definitions/PatientEvent'
      - properties:
          role:
            type: string
            enum:
              - Admitting
              - Attending
              - CoveringNurse
              - CoveringProvider
              - PrimaryCare
            required: true
          name:
            type:
              $ref: '#/definitions/Name'
            required: true
          careteam_id:
            type: string
            required: true
        
  PatientLocationEvent:
    type: object
    allOf:
      - $ref: '#/definitions/PatientEvent'
      - properties:
          location:
            type:
              $ref: '#/definitions/Location'
            required: true
        
  PatientObservationEvent:
    type: object
    allOf:
      - $ref: '#/definitions/PatientEvent'
      - properties:
          status:
            type: string
            enum: []
            required: true
          units:
            type: string
            enum: []
            required: true

